package com.locdata.theatres.scraper;

import java.io.IOException;
import java.io.InputStreamReader;
import java.io.Reader;
import java.net.URL;
import java.nio.charset.Charset;

import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

import com.google.gson.JsonObject;
import com.google.gson.JsonParser;
import com.locdata.geocoding.google.service.GeoCodeEntityCarrierToExcelWriter;
import com.locdata.geocoding.google.service.GeoCodingApi;
import com.locdata.google.api.sheetsWriter.SheetLocalWriter;
import com.locdata.scraper.main.ScraperLogic;
import com.locdata.utils.common.CommonUtils;

/*
 * Still needs work in it
 */

public class Theatres_SilverCity_LocData {

public static void main(String args[]) throws IOException, InterruptedException {
	
	String[] theatreNames = {"SilverCity Windsor Cinemas","SilverCity Thunder Bay Cinemas","SilverCity Sudbury Cinemas",
							"SilverCity Richmond Hill Cinemas (UltraAVX)","Scotiabank Theatre Ottawa ","SilverCity London Cinemas",
							"SilverCity Newmarket Cinemas and XSCAPE Entertainment Centre",
							"SilverCity Burlington Cinemas","SilverCity Brampton Cinemas",
							"SilverCity St. Vital Cinemas","SilverCity CrossIron Mills Cinemas & XSCAPE Entertainment Centre","SilverCity Victoria Cinemas",
							"SilverCity Riverport Cinemas","SilverCity Mission Cinemas"};
	
	for(String url: theatreNames){
	
		Document document = ScraperLogic.Scraper.fetchHtmlContents("https://www.cineplex.com/Theatres/TheatreListings?LocationURL="+url+"&Range=50");

		CommonUtils.checkDoc(document,Theatres_SilverCity_LocData.class);
		
		//final GeoCodeEntityCarrierToExcelWriter cineplexMasterData = new GeoCodeEntityCarrierToExcelWriter();
		
		//cineplexMasterData.setStorename(action);

		Elements t = document.body().select("div#Wrapper");
		
		t.forEach((theatrelist) -> {
			
			Elements k = theatrelist.select(".showtime-theatre");
			
			for(Element q : k){
							
							System.out.println(" Address ------> " + q.select(".theatre-address").text());
							System.out.println("  $$$$ "  + q.getElementsByAttributeValue("itemprop", "telephone").text());
						//	cineplexMasterData.setPhoneNumber(q.getElementsByAttributeValue("itemprop", "telephone").text());
							try {
							//	new GeoCodingApi(q.select(".theatre-address").text(),cineplexMasterData);
							} catch (Exception e1) {
								System.out.println(" Exception Printed !!! ");
							}
				}
			});
		cineplexKeyDataSet.add(cineplexMasterData);
	});
	  SheetLocalWriter.writeXLSXFile("CineplexTheatres.xlsx",cineplexKeyDataSet);
	  
	}
	
	
}
}
