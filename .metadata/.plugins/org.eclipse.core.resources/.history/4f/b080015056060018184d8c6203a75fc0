package com.locdata.theatres.scraper; 

import java.io.IOException;
import java.net.URL;
import java.util.ArrayList;
import java.util.LinkedHashSet;
import java.util.List;
import java.util.Set;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.parser.Parser;

import com.locdata.geocoding.google.service.GeoCodeEntityCarrierToExcelWriter;
import com.locdata.theatres.entity.EntityTheatre;
import com.locdata.utils.common.CommonUtils;

/*
 * Store Number
   Store Name 
   Address
   Address Line 2
   City
   State
   Zip Code
   Phone Number
   Latitude
   Longitude
   Geo Accuracy
   Country
   Country Code
   County
 */

public class Theatres_AMCEntertainment_AggData {

	static List<String> theatres = new ArrayList<String>();
	static List<EntityTheatre> address = new ArrayList<EntityTheatre>();
	public static Set<GeoCodeEntityCarrierToExcelWriter> amcKeyDataSet = new LinkedHashSet<GeoCodeEntityCarrierToExcelWriter>();

	public static void main(String args[]) throws IOException {

		String parentUrl = "https://www.amctheatres.com/sitemaps/sitemap-theatres.xml";

		Document doc = Jsoup.parse(new URL(parentUrl).openStream(), "UTF-8", "", Parser.xmlParser());
		doc.wait(20000000);
		CommonUtils.checkDoc(doc,Theatres_AMCEntertainment_AggData.class);

		// Select the first element "movie"
		Element movieFromXml = doc.select("url").first();
		// Get its attribute "genre"
		String genre = movieFromXml.attr("loc");
		// Print the result
		System.out.println(genre);
		

			
//		Element t = doc.getElementById("tabs-tabs");
//		Elements t_1 = t.select(".tab-content");
//		
//		for (Element r : t_1) {
//
//			Elements re = r.select(".Link.Link--arrow.Link--reversed.Link--arrow--txt--tiny.txt--tiny");
//
//			for (Element k : re) {
//				System.out.println(parentUrl.concat(k.attr("href")));
//				theatres.add(parentUrl.concat(k.attr("href")));
//				System.out.println(k.text());
//				// address.add(new EntityTheatre().setCountyName(k.text()));
//			}
//		}
//
//		ListIterator<String> itr = theatres.listIterator();
//
//		while (itr.hasNext()) {
//
//			Document doc_1 = ScraperLogic.Scraper.fetchHtmlContents(itr.next());
//
//			CommonUtils.checkDoc(doc_1,Theatres_AMCEntertainment_AggData.class);
//
//
//			Elements tr = doc_1.select(".TheatreInfo");
//			System.out.println(tr.size());
//			final GeoCodeEntityCarrierToExcelWriter entity = new GeoCodeEntityCarrierToExcelWriter();
//
//			for (Element e : tr) {
//				
//				String storename = e.select(".Link-text.Headline--h3").text().trim();
//				
//				if(storename != null && !storename.isEmpty()){
//					System.out.println(" -------->>>>>>>>> " + e.select(".Link-text.Headline--h3").text());
//					entity.setStorename(storename);
//				}
//				
//				System.out.println(" ==============> Theatre Website " + e.select("a").attr("href"));
//
//				System.out.println(
//						" ==============> address " + e.select(".TheatreInfo-address.Headline--eyebrow").text());
//				String address =  e.select(".TheatreInfo-address.Headline--eyebrow").text();
//				if(address != null && !address.isEmpty()){
//					entity.setAddress(e.select(".TheatreInfo-address.Headline--eyebrow").text());
//					new GeoCodingApi(entity.getAddress(),entity);
//					amcKeyDataSet.add(entity);
//				}
//				
//						amcKeyDataSet.forEach((action) ->{
//							StringBuilder builder = new StringBuilder();
//							builder.append(action.getAddress() + " --> " + action.getCity() + " --> " + action.getCountry() + " --> " + action.getCountryCode() + " --> " + action.getCounty()
//							+ " --> " + action.getLatitude() + " --> " + action.getLongitude() +" --> " + action.getState() + " --> " + action.getZipcode());
//							System.out.println(" builder ::::  " + builder.toString());
//						});
//						
//				}
//				        	
//			//	address.add(entity);
//		}
//		SheetLocalWriter.writeXLSXFile("AmcEntertainment.xlsx",amcKeyDataSet);
	}
}