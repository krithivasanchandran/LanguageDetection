package com.locdata.theatres.scraper; 

import java.io.IOException;
import java.util.ArrayList;
import java.util.LinkedHashSet;
import java.util.List;
import java.util.Set;

import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.TransformerConfigurationException;

import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.SAXException;

import com.XMLParser.LocData.XmlParser;
import com.locdata.geocoding.google.service.GeoCodeEntityCarrierToExcelWriter;
import com.locdata.theatres.entity.EntityTheatre;

/*
 * Store Number
   Store Name 
   Address
   Address Line 2
   City
   State
   Zip Code
   Phone Number
   Latitude
   Longitude
   Geo Accuracy
   Country
   Country Code
   County
 */

public class Theatres_AMCEntertainment_AggData {

	static List<String> theatres = new ArrayList<String>();
	static List<EntityTheatre> address = new ArrayList<EntityTheatre>();
	public static Set<GeoCodeEntityCarrierToExcelWriter> amcKeyDataSet = new LinkedHashSet<GeoCodeEntityCarrierToExcelWriter>();

	public static void main(String args[]) throws IOException, TransformerConfigurationException, ParserConfigurationException, SAXException {

		String parentUrl = "https://www.amctheatres.com/sitemaps/sitemap-theatres.xml";
		org.w3c.dom.Document document = XmlParser.parseXml(parentUrl);
	        
	        NodeList nodeList = document.getElementsByTagName("PageMap");
		
	        for (int i = 0; i < nodeList.getLength(); i++) {
	        	
	        	org.w3c.dom.Node node = nodeList.item(i);
	        	 if (node.getNodeType() == Node.ELEMENT_NODE) {
	        		 org.w3c.dom.Element eElement = ( org.w3c.dom.Element ) node;
	                 System.out.println("title: " + eElement.getAttribute("title"));
	     			System.out.println("Theatre Id : " + eElement.getElementsByTagName("theatreId").item(0).getTextContent());
	     			System.out.println("Address Line1 : " + eElement.getElementsByTagName("addressLine1").item(0).getTextContent());
	     			System.out.println(" City : " + eElement.getElementsByTagName("city").item(0).getTextContent());
	     			System.out.println("Salary : " + eElement.getElementsByTagName("postalCode").item(0).getTextContent());

	             }
	        }
			
//		Element t = doc.getElementById("tabs-tabs");
//		Elements t_1 = t.select(".tab-content");
//		
//		for (Element r : t_1) {
//
//			Elements re = r.select(".Link.Link--arrow.Link--reversed.Link--arrow--txt--tiny.txt--tiny");
//
//			for (Element k : re) {
//				System.out.println(parentUrl.concat(k.attr("href")));
//				theatres.add(parentUrl.concat(k.attr("href")));
//				System.out.println(k.text());
//				// address.add(new EntityTheatre().setCountyName(k.text()));
//			}
//		}
//
//		ListIterator<String> itr = theatres.listIterator();
//
//		while (itr.hasNext()) {
//
//			Document doc_1 = ScraperLogic.Scraper.fetchHtmlContents(itr.next());
//
//			CommonUtils.checkDoc(doc_1,Theatres_AMCEntertainment_AggData.class);
//
//
//			Elements tr = doc_1.select(".TheatreInfo");
//			System.out.println(tr.size());
//			final GeoCodeEntityCarrierToExcelWriter entity = new GeoCodeEntityCarrierToExcelWriter();
//
//			for (Element e : tr) {
//				
//				String storename = e.select(".Link-text.Headline--h3").text().trim();
//				
//				if(storename != null && !storename.isEmpty()){
//					System.out.println(" -------->>>>>>>>> " + e.select(".Link-text.Headline--h3").text());
//					entity.setStorename(storename);
//				}
//				
//				System.out.println(" ==============> Theatre Website " + e.select("a").attr("href"));
//
//				System.out.println(
//						" ==============> address " + e.select(".TheatreInfo-address.Headline--eyebrow").text());
//				String address =  e.select(".TheatreInfo-address.Headline--eyebrow").text();
//				if(address != null && !address.isEmpty()){
//					entity.setAddress(e.select(".TheatreInfo-address.Headline--eyebrow").text());
//					new GeoCodingApi(entity.getAddress(),entity);
//					amcKeyDataSet.add(entity);
//				}
//				
//						amcKeyDataSet.forEach((action) ->{
//							StringBuilder builder = new StringBuilder();
//							builder.append(action.getAddress() + " --> " + action.getCity() + " --> " + action.getCountry() + " --> " + action.getCountryCode() + " --> " + action.getCounty()
//							+ " --> " + action.getLatitude() + " --> " + action.getLongitude() +" --> " + action.getState() + " --> " + action.getZipcode());
//							System.out.println(" builder ::::  " + builder.toString());
//						});
//						
//				}
//				        	
//			//	address.add(entity);
//		}
//		SheetLocalWriter.writeXLSXFile("AmcEntertainment.xlsx",amcKeyDataSet);
	}
}