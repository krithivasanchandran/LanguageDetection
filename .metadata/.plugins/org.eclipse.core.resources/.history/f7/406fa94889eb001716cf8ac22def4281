package edu.uci.ics.crawler4j.crawler;

import java.io.IOException;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;
import java.util.ListIterator;

import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;

public class Theatres_AMCEntertainment_AggData {
	
	static List<String> theatres = new ArrayList<String>(); 
	static List<EntityTheatre> address = new ArrayList<EntityTheatre>(); 
	
		public static void main(String args[]) throws IOException{
			
			String parentUrl =  "https://www.amctheatres.com";
	      
			 Document doc = Jsoup.connect("	https://www.amctheatres.com/movie-theatres").userAgent("Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36")
		                	.get();
			 
			Element t = doc.getElementById("tabs-tabs");
		    Elements t_1 = t.select(".tab-content");
		    
		    for(Element r : t_1){
		    	
		    	Elements re = r.select(".Link.Link--arrow.Link--reversed.Link--arrow--txt--tiny.txt--tiny");
		    	
		    	for(Element k : re)
		    	{
		    		System.out.println(parentUrl.concat(k.attr("href")));
		    		theatres.add(parentUrl.concat(k.attr("href")));
			    	System.out.println(k.text());
			    //	address.add(new EntityTheatre().setCountyName(k.text()));
		    	}
		    }
		    
		    ListIterator<String> itr = theatres.listIterator();
		    
		    while(itr.hasNext()){
		    	
		    	 Document doc_1 = Jsoup.connect(itr.next()).userAgent("Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/63.0.3239.108 Safari/537.36")
		                	.timeout(100000).get();
		    	 
		    	 Elements tr = doc_1.select(".TheatreInfo");
		    	 System.out.println(tr.size());
		    	 EntityTheatre entity=null;
		    	 
		    	 for(Element e : tr)
		    	 {
		    		 entity = new EntityTheatre();
		    		 System.out.println(" -------->>>>>>>>> "  + e.select(".Link-text.Headline--h3").text());
		    		 entity.setTheatreStoreName(e.select(".Link-text.Headline--h3").text());
		    		 System.out.println(" ==============> Theatre Website " + e.select("a").attr("href"));
		    		 entity.setTheatreWebsite(parentUrl.concat(e.select("a").attr("href")));
		    		 System.out.println(" ==============> address " + e.select(".TheatreInfo-address.Headline--eyebrow").text());
		    		 entity.setAddress(e.select(".TheatreInfo-address.Headline--eyebrow").text());
		    		 address.add(entity);
		    	 }
		    }
		    System.out.println("Fetching the details");
		    System.out.println(Arrays.toString(address.toArray()));
		}
}