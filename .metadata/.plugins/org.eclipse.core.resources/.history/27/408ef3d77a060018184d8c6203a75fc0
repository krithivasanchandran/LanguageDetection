package com.locdata.theatres.scraper; 

import java.io.IOException;
import java.util.ArrayList;
import java.util.LinkedHashSet;
import java.util.List;
import java.util.Set;

import javax.xml.bind.JAXBException;
import javax.xml.parsers.ParserConfigurationException;
import javax.xml.transform.TransformerConfigurationException;

import org.w3c.dom.NamedNodeMap;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;
import org.xml.sax.SAXException;

import com.XMLParser.LocData.XmlParser;
import com.locdata.geocoding.google.service.GeoCodeEntityCarrierToExcelWriter;
import com.locdata.theatres.entity.EntityTheatre;

/*
 * Store Number
   Store Name 
   Address
   Address Line 2
   City
   State
   Zip Code
   Phone Number
   Latitude
   Longitude
   Geo Accuracy
   Country
   Country Code
   County
 */

public class Theatres_AMCEntertainment_AggData {

	static List<String> theatres = new ArrayList<String>();
	static List<EntityTheatre> address = new ArrayList<EntityTheatre>();
	public static Set<GeoCodeEntityCarrierToExcelWriter> amcKeyDataSet = new LinkedHashSet<GeoCodeEntityCarrierToExcelWriter>();

	public static void main(String args[]) throws  JAXBException, IOException, TransformerConfigurationException, ParserConfigurationException, SAXException {

		String parentUrl = "https://www.amctheatres.com/sitemaps/sitemap-theatres.xml";
		org.w3c.dom.Document document = XmlParser.parseXml(parentUrl);
		
		document.getDocumentElement().normalize();
		
		 NodeList nodeList = document.getElementsByTagName("urlset");
		 NodeList items = document.getElementsByTagName("PageMap");
		 for (int i = 0; i < items.getLength(); i++)
         {
             Node n = items.item(i);
             if (n.getNodeType() != Node.ELEMENT_NODE)
                 continue;
             Element e = (Element) n;

             // get the "title elem" in this item (only one)
             NodeList titleList = 
                             e.getElementsByTagName("title");
             Element titleElem = (Element) titleList.item(0);

             // get the "text node" in the title (only one)
             Node titleNode = titleElem.getChildNodes().item(0);
             System.out.println(titleNode.getNodeValue());
         }
		 
//	        for (int i = 0; i < nodeList.getLength(); i++) {
//	        	org.w3c.dom.Node node = nodeList.item(i);
//	        	 NamedNodeMap map = node.getAttributes();
//	        	 if(node.getNodeType() == org.apache.xmlbeans.impl.soap.Node.ATTRIBUTE_NODE){
//	        		 System.out.println(map.getNamedItem("addressLine1").getTextContent());
//	        	 }
//	        }
			
//		Element t = doc.getElementById("tabs-tabs");
//		Elements t_1 = t.select(".tab-content");
//		
//		for (Element r : t_1) {
//
//			Elements re = r.select(".Link.Link--arrow.Link--reversed.Link--arrow--txt--tiny.txt--tiny");
//
//			for (Element k : re) {
//				System.out.println(parentUrl.concat(k.attr("href")));
//				theatres.add(parentUrl.concat(k.attr("href")));
//				System.out.println(k.text());
//				// address.add(new EntityTheatre().setCountyName(k.text()));
//			}
//		}
//
//		ListIterator<String> itr = theatres.listIterator();
//
//		while (itr.hasNext()) {
//
//			Document doc_1 = ScraperLogic.Scraper.fetchHtmlContents(itr.next());
//
//			CommonUtils.checkDoc(doc_1,Theatres_AMCEntertainment_AggData.class);
//
//
//			Elements tr = doc_1.select(".TheatreInfo");
//			System.out.println(tr.size());
//			final GeoCodeEntityCarrierToExcelWriter entity = new GeoCodeEntityCarrierToExcelWriter();
//
//			for (Element e : tr) {
//				
//				String storename = e.select(".Link-text.Headline--h3").text().trim();
//				
//				if(storename != null && !storename.isEmpty()){
//					System.out.println(" -------->>>>>>>>> " + e.select(".Link-text.Headline--h3").text());
//					entity.setStorename(storename);
//				}
//				
//				System.out.println(" ==============> Theatre Website " + e.select("a").attr("href"));
//
//				System.out.println(
//						" ==============> address " + e.select(".TheatreInfo-address.Headline--eyebrow").text());
//				String address =  e.select(".TheatreInfo-address.Headline--eyebrow").text();
//				if(address != null && !address.isEmpty()){
//					entity.setAddress(e.select(".TheatreInfo-address.Headline--eyebrow").text());
//					new GeoCodingApi(entity.getAddress(),entity);
//					amcKeyDataSet.add(entity);
//				}
//				
//						amcKeyDataSet.forEach((action) ->{
//							StringBuilder builder = new StringBuilder();
//							builder.append(action.getAddress() + " --> " + action.getCity() + " --> " + action.getCountry() + " --> " + action.getCountryCode() + " --> " + action.getCounty()
//							+ " --> " + action.getLatitude() + " --> " + action.getLongitude() +" --> " + action.getState() + " --> " + action.getZipcode());
//							System.out.println(" builder ::::  " + builder.toString());
//						});
//						
//				}
//				        	
//			//	address.add(entity);
//		}
//		SheetLocalWriter.writeXLSXFile("AmcEntertainment.xlsx",amcKeyDataSet);
	}
}